@import "./tokens.css";

/* ================================
   Tailwind base/components/utilities
   ================================ */
@tailwind base;
@tailwind components;
@tailwind utilities;

/* ================================
   Utility Classes
   ================================ */
@layer utilities {
  /* Hide scrollbar for Chrome, Safari and Opera */
  .hide-scrollbar::-webkit-scrollbar {
    display: none;
  }

  /* Hide scrollbar for IE, Edge and Firefox */
  .hide-scrollbar {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }

  /* Screen reader only */
  .sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border-width: 0;
  }

  /* Reveal sr-only utilities on focus (skip links, etc.) */
  .sr-only:focus,
  .sr-only:active {
    position: static;
    width: auto;
    height: auto;
    padding: inherit;
    margin: inherit;
    overflow: visible;
    clip: auto;
    white-space: normal;
  }

  .safe-area-bottom-fab {
    bottom: calc(env(safe-area-inset-bottom, 0px) + var(--space-fab-offset));
  }

  .bg-glow-ring-primary {
    background: var(--gradient-glow-ring-primary);
  }

  .bg-glow-ring-neutral {
    background: var(--gradient-glow-ring-neutral);
  }

  .blur-aurora-lg {
    filter: blur(var(--aurora-blur-lg));
  }

  .blur-aurora-md {
    filter: blur(var(--aurora-blur-md));
  }

  .hscroll {
    display: flex;
    gap: var(--space-7);
    overflow-x: auto;
    overflow-y: hidden;
    padding-bottom: var(--space-5);
    -webkit-overflow-scrolling: touch;
    scrollbar-width: none;
    -ms-overflow-style: none;
    overscroll-behavior-x: contain;
  }

  .hscroll::-webkit-scrollbar {
    display: none;
  }

  .hscroll-snap {
    scroll-snap-type: x proximity;
  }

  @media (min-width: 1024px) {
    .hscroll-snap {
      scroll-snap-type: x mandatory;
    }
  }

  .hscroll-item {
    flex-shrink: 0;
    scroll-snap-align: start;
  }

  .token-interactive {
    --token-bg: var(--color-bg-elevated);
    --token-bg-hover: var(--color-bg-elevated);
    --token-bg-hover: color-mix(in srgb, var(--color-bg-elevated) 88%, var(--color-primary-500));
    --token-bg-active: var(--color-bg-elevated);
    --token-bg-active: color-mix(in srgb, var(--color-bg-elevated) 82%, var(--color-primary-600));
    --token-fg: var(--color-text-primary);
    --token-fg-hover: var(--color-text-primary);
    --token-fg-active: var(--color-text-primary);
    --token-shadow: none;
    --token-shadow-hover: none;
    --token-shadow-active: none;
    --token-border-color: var(--color-border-default);
    --token-border-color-hover: var(--color-border-hover);
    --token-border-color-active: var(--color-border-focus);
    --token-transform-hover: translateY(-0.125rem);
    --token-transform-active: translateY(-0.0625rem);
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: var(--space-3);
    background: var(--token-bg);
    color: var(--token-fg);
    box-shadow: var(--token-shadow);
    border-color: var(--token-border-color);
    border-style: solid;
    border-width: var(--token-border-width, 1px);
    border-radius: var(--radius-lg);
    transition: transform 300ms cubic-bezier(0.4, 0, 0.2, 1),
      box-shadow 300ms cubic-bezier(0.4, 0, 0.2, 1),
      background 300ms cubic-bezier(0.4, 0, 0.2, 1),
      color 300ms cubic-bezier(0.4, 0, 0.2, 1),
      border-color 300ms cubic-bezier(0.4, 0, 0.2, 1);
  }

  .token-interactive:hover,
  .token-interactive:focus-visible {
    background: var(--token-bg-hover);
    color: var(--token-fg-hover);
    box-shadow: var(--token-shadow-hover);
    border-color: var(--token-border-color-hover);
    transform: var(--token-transform-hover);
  }

  .token-interactive:active {
    background: var(--token-bg-active);
    color: var(--token-fg-active);
    box-shadow: var(--token-shadow-active);
    border-color: var(--token-border-color-active);
    transform: var(--token-transform-active);
  }

  .token-icon-button {
    --token-icon-size: var(--space-10);
    --token-icon-radius: var(--radius-full);
    --token-icon-bg: transparent;
    --token-icon-bg-hover: transparent;
    --token-icon-bg-hover: color-mix(in srgb, var(--color-primary-500) 12%, transparent);
    --token-icon-color: var(--color-text-primary);
    --token-icon-color-hover: var(--color-primary-500);
    --token-icon-shadow: none;
    --token-icon-shadow-hover: none;
    width: var(--token-icon-size);
    height: var(--token-icon-size);
    display: inline-flex;
    align-items: center;
    justify-content: center;
    border-radius: var(--token-icon-radius);
    background: var(--token-icon-bg);
    color: var(--token-icon-color);
    box-shadow: var(--token-icon-shadow);
    transition: background 250ms cubic-bezier(0.4, 0, 0.2, 1),
      color 250ms cubic-bezier(0.4, 0, 0.2, 1),
      box-shadow 250ms cubic-bezier(0.4, 0, 0.2, 1),
      transform 250ms cubic-bezier(0.4, 0, 0.2, 1);
  }

  .token-icon-button:hover,
  .token-icon-button:focus-visible {
    background: var(--token-icon-bg-hover);
    color: var(--token-icon-color-hover);
    box-shadow: var(--token-icon-shadow-hover);
  }

  .token-icon-button:active {
    transform: scale(0.96);
  }
}

/* ======================
   خطوط محلية (كما هي)
   ====================== */
@font-face { font-family: 'Almarai'; font-weight: 300; src: url('/fonts/Almarai-Light.ttf') format('truetype'); font-display: swap; }
@font-face { font-family: 'Almarai'; font-weight: 400; src: url('/fonts/Almarai-Regular.ttf') format('truetype'); font-display: swap; }
@font-face { font-family: 'Almarai'; font-weight: 700; src: url('/fonts/Almarai-Bold.ttf') format('truetype'); font-display: swap; }
@font-face { font-family: 'Almarai'; font-weight: 800; src: url('/fonts/Almarai-ExtraBold.ttf') format('truetype'); font-display: swap; }
@font-face { font-family: 'Outfit';  font-weight: 400; src: url('/fonts/Outfit-Regular.ttf') format('truetype'); font-display: swap; }
@font-face { font-family: 'Outfit';  font-weight: 500; src: url('/fonts/Outfit-Medium.ttf')  format('truetype'); }
@font-face { font-family: 'Orlean';  font-weight: 400; src: url('/fonts/Orlean-Regular.otf') format('opentype'); font-display: swap; }

/* ==============================
   Base layer: خلفيات + سكروول + فوكس
   ============================== */
@layer base {
  body {
    @apply antialiased;
    font-family: var(--font-arabic);
    color: var(--color-text-primary);
    background: var(--gradient-hero);
    transition: background 300ms cubic-bezier(0.4, 0, 0.2, 1),
      color 300ms cubic-bezier(0.4, 0, 0.2, 1);
  }

  /* Scrollbar عامة (لغير الأقسام الأفقية) */
  ::-webkit-scrollbar {
    width: var(--space-3);
    height: var(--space-3);
  }

  ::-webkit-scrollbar-track {
    background: var(--color-bg-secondary);
    background: color-mix(in srgb, var(--color-bg-secondary) 75%, transparent);
    border-radius: var(--radius-sm);
  }

  ::-webkit-scrollbar-thumb {
    background: linear-gradient(45deg, var(--color-primary-500), var(--color-primary-600));
    border-radius: var(--radius-sm);
    border: var(--space-1) solid transparent;
    background-clip: padding-box;
  }

  ::-webkit-scrollbar-thumb:hover {
    background: linear-gradient(45deg, var(--color-primary-600), var(--color-primary-700));
  }
}

/* ==============================
   Motion preferences
   ============================== */
@media (prefers-reduced-motion: no-preference) {
  html {
    scroll-behavior: smooth;
  }
}

/* ==============================
   Print
   ============================== */
@media print {
  .no-print { display: none !important; }
}

/* ===== Global: منع أي سكروول أفقي على الصفحة ===== */
html, body {
  /* clip أفضل من hidden ولا يكسر sticky/position */
  overflow-x: clip;
}

/* Fallback لو المتصفح ما يدعم clip */
@supports not (overflow: clip) {
  html, body { overflow-x: hidden; }
}

/* ===== WebKit فقط: إخفاء شريط التمرير الأفقي بصريًا، مع بقاء السحب شغّال ===== */
*::-webkit-scrollbar:horizontal { height: 0 !important; }
*::-webkit-scrollbar-thumb:horizontal { background: transparent !important; }
*::-webkit-scrollbar-track:horizontal { background: transparent !important; }

/* ================================
   Accessibility Utilities
   ================================ */

/* تحسين Focus Indicators - مرئية وواضحة */
*:focus-visible {
  outline: var(--space-1) solid var(--color-primary-500);
  outline-offset: var(--space-1);
  border-radius: var(--radius-sm);
}

.dark *:focus-visible {
  outline-color: var(--color-primary-400);
}

/* إزالة outline للماوس فقط، مع الحفاظ عليه للكيبورد */
*:focus:not(:focus-visible) {
  outline: none;
}

/* تحسين focus للأزرار */
button:focus-visible,
a:focus-visible {
  outline: var(--space-1) solid var(--color-primary-500);
  outline-offset: var(--space-1);
}

/* تحسين focus للـ inputs */
input:focus-visible,
textarea:focus-visible,
select:focus-visible {
  outline: var(--space-1) solid var(--color-primary-500);
  outline-offset: 0;
  border-color: var(--color-primary-500);
}

/* تحسين Contrast في Dark Mode */
@media (prefers-contrast: high) {
  :root {
    --color-primary-500: var(--color-primary-500);
    --color-primary-500: color-mix(in srgb, var(--color-primary-500) 80%, var(--color-text-inverse) 20%);
  }

  button,
  a {
    border: 2px solid currentColor;
  }
}

/* Skip to Content Link Styling */
.skip-to-content {
  position: absolute;
  top: calc(-1 * var(--space-10));
  left: 0;
  background: var(--color-primary-500);
  color: var(--color-text-inverse);
  padding: var(--space-3) var(--space-4);
  text-decoration: none;
  border-radius: 0 0 var(--radius-sm) 0;
  z-index: 100;
  font-weight: 600;
}

.skip-to-content:focus {
  top: 0;
}
